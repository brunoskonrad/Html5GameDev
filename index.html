<!DOCTYPE hmtl>
<html>
  <head>
    <title>Capítulo 1</title>
    <meta charset="UTF-8">
    
    <style>
      body {
        padding: 0;
        margin: 0;
      }
      #game_canvas {
        width: 100%;
        height: 100%;
      }
    </style>
  </head>
  <body>
    <canvas id="game_canvas">
    </canvas>
    <script>
      var canvas = document.getElementById("game_canvas")
        , context = canvas.getContext("2d")
        ;
      
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight
      
      console.log(canvas.width);
      console.log(canvas.height);
      
      // Desenha o OVNI
      var ovni = new Image();
      ovni.src = 'img/ovni.png';
      ovni.onload = function() {
        var x = 20
          , width = 64
          , height = 32;
        for (var i = 0; i < 5; i++) {
          context.drawImage(ovni, x, 20, width, height);
          x += 70;
        }
      };
      
      // Desenha o Spritesheet
      var explosao = new Image();
      explosao.src = 'img/explosao.png';
      explosao.onload = function() {
        context.drawImage(explosao, 
                          // Área de recorte
                          80, 10, 60, 65,
                          // Desenho no canvas
                          20, 64, 60, 65);
      };
      
      var x = 0;
      var y = 0;
      var dx = 10, qx = 1;
      var dy = 10, qy = 1;
      var anterior = new Date().getTime();
      
      
      function mecherExplosao() {
        var agora = new Date().getTime()
          , decorrido = agora - anterior;
        
        console.log(anterior);
        console.log(agora);
        console.log(decorrido);
        
        anterior = agora;
        
        context.clearRect(0, 0, canvas.width, canvas.height);
        context.drawImage(explosao, 
                          // Área de recorte
                          80, 10, 60, 65,
                          // Desenho no canvas
                          x, y, 60, 65);
        var fps = 1000/ 60;
        
        x += (dx * decorrido / fps) * qx;
        y += (dy * decorrido / fps) * qy;
        
        if (x > canvas.width - 60 || x < 0) {
          qx *= -1; 
        }
        
        if (y > canvas.height - 65 || y < 0) {
          qy *= -1; 
        }
        requestAnimationFrame(mecherExplosao);
      }
      requestAnimationFrame(mecherExplosao);
    </script>
  </body>
</html>